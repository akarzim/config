function ComboSearch(b,a,c,d){this.query=b;this.tabId=a;this.element=c;this.issearcho=d}
extend(ComboSearch,{init:function(){},onTabUpdated:function(b,a,c,d){c=c.url;var e;if(!(a.status!="loading"||!SignInManager.isSignedIn())){if(/\.google\./.test(c)){e=(a=c.match(/(&q|\?q)=(.*?)(&|$)/))&&a[2];var f="#center_col"}else if(/\.bing\./.test(c)){e=(a=c.match(/(&q|\?q)=(.*?)(&|$)/))&&a[2];f="#results_container"}else if(/\.yahoo\./.test(c)){e=(a=c.match(/(&p|\?p)=(.*?)(&|$)/))&&a[2];f="#web"}(new this(e,b,f,d)).search()}},isGoogleSearch:function(b){if(!/\.google\./.test(b))return null;return(b=
b.match(/&q=(.*?)(&|$)/))&&b[1]}});
extend(ComboSearch.prototype,{discard:function(){this.discarded=true;this.api.cancel()},inject:function(){chrome.tabs.insertCSS(this.tabId,{file:"css/comboSearch.css"});chrome.tabs.executeScript(this.tabId,{file:"js/content/comboSearch.js"})},search:function(){var b=this;b.inject();(new WebAPICall).invoke("search_myLibraryLite",{query:decodeURIComponent(b.query.replace(/\+/g,"%20"))},{user:GlobalData.user,complete:function(a){if(!a.cancelled)(a=a.resp)&&a.code==1&&b.onResult(a.result)}})},onResult:function(b){var a=
this;a.discarded||chrome.tabs.get(a.tabId,function(c){chrome.tabs.executeScript(c.id,{code:"ComboSearch.showResult("+JSON.stringify({total:b.total,element:a.element,issearcho:a.issearcho,query:a.query,isPremiumUser:GlobalData.permissions.snapshot})+")"})})}});function SearchO(b,a,c){this.query=b;this.tabId=a;this.iscombosearch=c}
extend(SearchO,{init:function(b,a,c,d){c=c.url;chrome.tabs.insertCSS(this.tabId,{file:"css/comboSearch.css"});chrome.tabs.executeScript(this.tabId,{file:"js/content/searcho.js"});if(a.status=="loading")if(/\.google\./.test(c)){a=(a=c.match(/(&q|\?q)=(.*?)(&|$|#)/))&&a[2];(new this(a,b,d)).google()}else if(/\.bing\./.test(c)){a=(a=c.match(/(&q|\?q)=(.*?)(&|$|#)/))&&a[2];(new this(a,b,d)).bing()}else if(/\.yahoo\./.test(c)){a=(a=c.match(/(&p|\?p)=(.*?)(&|$|#)/))&&a[2];(new this(a,b,d)).yahoo()}}});
extend(SearchO.prototype,{google:function(){var b=this;chrome.tabs.get(b.tabId,function(a){chrome.tabs.executeScript(a.id,{code:"searcho.showResult("+JSON.stringify({query:b.query,iscombosearch:b.iscombosearch,element:"#center_col"})+")"})})},bing:function(){var b=this;chrome.tabs.get(b.tabId,function(a){chrome.tabs.executeScript(a.id,{code:"searcho.showResult("+JSON.stringify({query:b.query,iscombosearch:b.iscombosearch,element:"#results_container"})+")"})})},yahoo:function(){var b=this;chrome.tabs.get(b.tabId,
function(a){chrome.tabs.executeScript(a.id,{code:"searcho.showResult("+JSON.stringify({query:b.query,iscombosearch:b.iscombosearch,element:"#web"})+")"})})}});
